#include "firework.h"
#include "oled.h"

unsigned char fireworkdata[]={
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,192,224,224,224,192,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,7,15,15,15,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,128,128,128,128,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,248,252,254,255,255,255,255,255,255,255,255,255,255,255,254,252,248,224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,63,127,255,255,255,255,255,255,255,255,255,255,255,255,255,127,63,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,3,3,3,3,3,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32,192,0,0,0,4,248,0,0,224,16,0,0,0,128,96,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,32,68,136,136,240,249,254,252,252,255,254,254,255,254,252,252,255,248,232,68,64,64,64,64,32,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,4,130,66,66,39,63,127,127,255,255,255,255,255,255,255,127,127,95,79,132,4,4,8,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,3,0,12,3,0,0,1,14,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,128,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,128,0,0,0,0,0,4,24,32,64,128,0,0,0,0,0,31,224,0,255,0,0,0,128,64,32,24,6,1,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,1,1,2,2,130,130,132,132,136,144,17,34,44,80,96,192,135,254,193,176,136,70,65,32,32,16,16,16,16,8,8,4,4,2,0,0,0,0,0,0,0,
0,0,0,0,0,128,64,64,65,65,33,32,16,8,8,8,4,133,69,35,147,107,29,7,255,59,199,11,19,37,69,133,9,9,17,18,34,66,66,66,130,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,128,64,32,16,8,4,2,129,96,24,6,1,0,0,0,255,0,1,14,240,0,0,0,1,2,4,8,16,32,64,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,64,64,128,0,0,0,0,0,8,240,0,0,0,0,0,0,0,224,16,0,0,0,0,0,128,64,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,128,128,128,128,128,0,0,0,0,0,1,2,12,16,96,128,1,30,224,0,0,0,224,30,1,0,192,32,24,4,2,1,128,128,64,64,32,0,0,0,0,0,0,0,
0,0,0,0,0,0,128,128,128,129,65,66,66,132,132,136,16,0,0,1,0,0,0,0,0,0,0,0,0,3,0,8,4,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,128,128,64,32,32,16,16,16,136,72,32,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,5,5,5,5,9,10,10,18,18,32,0,0,0,0,0,
0,0,0,2,1,1,1,0,0,16,8,4,2,1,1,128,96,24,4,3,0,0,0,0,252,0,0,3,12,112,128,0,1,2,4,8,48,64,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,0,0,0,0,0,0,31,0,0,0,0,0,1,14,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,0,0,0,0,0,32,32,32,32,64,64,64,128,0,0,4,120,128,0,0,0,0,0,0,0,224,16,0,0,0,0,0,0,0,128,64,0,0,0,0,0,0,0,0,0,0,
0,0,128,64,64,64,64,128,128,0,0,0,0,0,0,3,4,0,0,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,12,2,1,0,0,128,128,64,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,
0,0,4,2,130,65,65,33,33,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,36,68,68,68,68,72,128,
0,0,0,0,0,0,0,128,64,32,16,8,0,0,0,0,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,128,0,0,8,16,32,64,128,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,1,0,0,0,0,0,0,0,4,3,0,0,0,0,0,0,0,0,63,64,0,0,0,0,0,0,1,6,8,0,0,0,0,1,2,0,0,0,0,0,0,0,

0,0,0,0,0,64,64,32,32,32,0,0,0,0,0,0,2,4,24,0,0,0,0,0,0,0,0,48,8,4,0,0,0,0,0,0,0,128,64,64,0,0,0,0,0,0,0,0,
0,128,128,128,64,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,64,64,32,32,32,64,0,
1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,16,8,4,4,128,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,136,136,8,16,
0,0,2,1,1,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,1,1,
0,0,0,0,0,4,2,1,0,0,0,0,0,0,48,14,0,0,0,0,0,0,0,0,112,128,0,0,0,0,0,0,2,4,24,32,0,0,0,1,2,12,0,0,0,0,0,0,

0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

void firework(int x, int y)
{
    OLED_ShowStr(6,0,"Happy New Year OvO",1);
    int xx = x + 24, yy = y + 3, yn = 6, i;
    unsigned char st = 0x80, ed = 0xff;
    for (i = 0; i < 8; i++)
    {
        OLED_SetPos(xx, 7);
        OLED_writebyte(st, OLED_DATA);
        st = (st >> 1) | 0x80;
        HAL_Delay(10);
        for (yn = 6; yn > yy; yn--)
        {
            st = 0x80;
            ed = 0x7f;
            for (i = 0; i < 8; i++)
            {
                OLED_SetPos(xx, yn);
                OLED_writebyte(st, OLED_DATA);
                OLED_SetPos(xx, yn + 1);
                OLED_writebyte(ed, OLED_DATA);
                st = (st >> 1) | 0x80;
                ed = ed >> 1;
                HAL_Delay(40 - yn * 5);
            }
        }
        st = 0x80;
        ed = 0x3f;
        for (i = 0; i < 8; i++)
        {
            OLED_SetPos(xx, yy);
            OLED_writebyte(st, OLED_DATA);
            OLED_SetPos(xx, yy + 1);
            OLED_writebyte(ed, OLED_DATA);
            st = (st >> 1) | 0x80;
            ed = ed >> 2;
            HAL_Delay(40 - yy * 5);
        }
         for (i = 0; i < 8; i++)
         {
             OLED_DrawBMP(x, y, 48, 48, &fireworkdata[i * 288]);
             if(i != 7) HAL_Delay(10);
             if(i == 7) HAL_Delay(40);
         }
    }
}
